Financial Contributions Made to Presidential Candidates by Aaron Gruberg
========================================================

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
                      echo=FALSE, warning=FALSE, message=FALSE)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
library(ggplot2)
library(tidyr)
library(dplyr)
library(readxl)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Load_the_Data}
# Load the Data
setwd("C:/Users/Aaron/Downloads") 

CA <- read.csv(file = "CA.csv", row.names = NULL)

colnames(CA) <- c(colnames(CA)[-1],"x")

# This added a dummy column named "x" that we need to remove
CA$x <- NULL 
```
# Data Description

I downloaded a csv file of contributions made to presidential candidates from 
Californians for the 2016 election.  I looked at how the money was distributed 
among candidates and which occupations and cities made the largest 
contributions.  Because most of the variables are categorical, I had to create
new variables from existing ones.  This dataset consists of 18 variables with 
1304346 observations. 

```{r echo=FALSE, message=FALSE, warning=FALSE, Data_Description}
# Describe the data
summary(CA)
```

# Univariate Plots Section

```{r echo=FALSE, warning=FALSE, Histograms}
# Histogram of the number of people who gave each amount
                                                                
ggplot(aes(x = contb_receipt_amt), data = CA) +
  geom_histogram(bins = 250) +
  scale_x_continuous(limits = c(0, 5000))


# Histogram of the log of the number of people who gave each amount

ggplot(aes(x = contb_receipt_amt), data = CA) +
  geom_histogram(bins = 250) +
  scale_x_continuous(limits = c(0, 5000)) +
  scale_y_log10()
```

The count of contribution amounts was very spread out.  There appear to be 
large gaps in the first histogram between contributions of $500 and $3000.  
Once I applied a log10() scale to the y axis these smaller counts were visible. 

```{r echo=FALSE, warning=FALSE, not_employed}
# Plot of contributions top candidates received from unemployed people

ggplot(data = subset(CA, CA$contbr_employer == 'NOT EMPLOYED'
                      & CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco'), aes(x = cand_nm)) +
  geom_histogram(stat = "count") +
  coord_flip()
```

This is a histogram of the number of contributions top candidates received from
unemployed people.  Bernie Sanders received the most contributions from 
this group of people.

```{r echo=FALSE, warning=FALSE, Univariate_Plots}
# Plot of contributions top candidates received from employed people

ggplot(data = subset(CA, (CA$contbr_employer != 'NOT EMPLOYED' 
                     | CA$contbr_employer != 'RETIRED')
                     & (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco')), aes(x = cand_nm)) +
  geom_histogram(stat = "count") +
  coord_flip()
```

This is the number of contributions top candidates received from employed 
people.  Hillary Clinton received the most contributions from employed people.

```{r echo=TRUE, warning=FALSE, Date_Format}

### Amount vs Date
### Change the date format by adding new date column
CA$contb_receipt_dt_date <- as.Date(CA$contb_receipt_dt, "%d-%b-%y")

### Add new columns for Year, Day, Month
CA$year = as.numeric(format(CA$contb_receipt_dt_date, format = "%Y"))
CA$month = as.numeric(format(CA$contb_receipt_dt_date, format = "%m"))
CA$day = as.numeric(format(CA$contb_receipt_dt_date, format = "%d"))
```

I used the 'as.Date' function to create a variable called contb_receipt_dt_date 
which converts the date format from '26-APR-16' to '2016-04-26'.  Then I added 
3 variables for the 'day', 'month', 'year'.

```{r echo=FALSE, warning=FALSE, frequency}
# Frequency Plot of Total Contributions vs Date, grouped by candidate name.
ggplot(subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\'')),  aes(contb_receipt_dt_date, colour = cand_nm)) +
  geom_freqpoly(binwidth = 20)
```


This is a frequency plot of the number of contributions received by date, 
grouped by candidate name.  Donald Trump did not receive many contributions 
until very close to the election date.  Below is a summary of occupations in 
the dataset.

```{r echo=FALSE, warning=FALSE, summary}
# Summary of the number of contributions made by each profession
summary(CA$contbr_occupation)
```

# Univariate Analysis

### What is the structure of your dataset?

There are 1304346 transactions in the dataset with 18 features(cmte_id, 
cand_id, cand_nm, contbr_name, contbr_city, contbr_state, contbr_zip, 
contbr_employer, contbr_occupation, contb_receipt_amt, contb_receipt_dt, 
receipt_desc, memo_cd, memo_text, form_tp, file_num, tran_id, election_tp).  
Most variables in the original dataset were categorical.

### What is/are the main feature(s) of interest in your dataset?

The main features in the dataset are contb_receipt_amt and cand_nm.  I'm 
interested in the amount of money going to a particular candidate and how 
it varies across categorical variables such as industry category, and county.  

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?

I also examine contb_receipt_dt to see how often a particular contribution is 
made as we get closer to the election date.

### Did you create any new variables from existing variables in the dataset?

I created a variable called contb_receipt_dt_date which converts the date 
format from '26-APR-16' to '2016-04-26'.  Then I added 3 variables for the 
'day', 'month', 'year'.

I created a variable 'total_contbr' to sum all the contributions a particular 
candidate receives on a particuluar date, and 'max_total_contbr' to find the 
cumulative sum a candidate received from all contributors on a particular date.

I created the variable 'contbr_industry' to group the 'contbr_occupation' 
values into BLUE COLLAR, WHITE COLLAR, MILITARY, STUDENT, UNEMPLOYED.

I created the variable 'contbr_county' so I could group the values in the 
'contbr_city' column and include this geographical data in my plots.  
'contbr_county' includes 7 counties(LA, SD, ORANGE, SAC, RIVERSIDE, SAN BERN, 
BAY AREA).

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

There was a sharp cutoff in the histogram of contribution amounts for values 
of $2700.  After this limit, far fewer counts were recorded.  I was expecting 
to see a distribition that resembled an exponential decay but there were also 
large spikes for contributions of 1000, 2000, and 2700.  

I used 'as.numeric' to convert the date values to numeric date values.  This 
allowed me to take the log of numeric date values for scaling purposes.

# Bivariate Plots Section

```{r echo=FALSE, message=FALSE, warning=FALSE, ggpairs}
## Plot Matrix
# Load additional libraries
library(GGally)
library(scales)
library(memisc)

# sample 10,000 transactions from the data set
set.seed(20022012)
new_CA <- subset(CA, 
                 select=c(cand_nm, contb_receipt_amt, contb_receipt_dt, 
                          form_tp, file_num))

CA_sample <- new_CA[sample(1:length(new_CA$contb_receipt_amt), 10000), ]
 
# Make ggpairs plot, need to increase cardinality threshold parameter!?
ggpairs(CA_sample, cardinality_threshold = 750, 
        axisLabels = c("show", "internal", "none"),
        lower = list(continuous = wrap("points", shape = I('.')), 
                     combo = "facethist", discrete = "facetbar", na = "na"),
        upper = list(continuous = wrap("cor"), combo = "box_no_facet", 
                  discrete = "facetbar", na = "na"),
        diag = list(continuous = "densityDiag", discrete = "barDiag", 
                    na = "naDiag"))
```

This plot matrix plots each variable against every other variable.  It wasn't 
very helpful for this dataset because most of the data were very large 
categorical variables.  This produced boxplots with hundredes of categorical 
values on the x axis.

```{r echo=FALSE, message=FALSE, warning=FALSE, amount_vs_filenum}
# SCATTER PLOT OF AMOUNT VS FILENUM
ggplot(aes(x = file_num, y = contb_receipt_amt), 
       data = subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco')
                     & CA$contb_receipt_amt > 0)) +
  geom_point()
```

There wasn't a strong relationship between contributionn amount and the file 
number of the form completed by contributors.  The correlation was -0.080.

```{r echo=FALSE, message=FALSE, warning=FALSE, scatter_amount_vs_date}

# scatterplot of amount vs date for selected candidates
# Only included dates in 2015-2016
# Only included amounts between -3000(refunds) and 3000.
ggplot(aes(x = contb_receipt_dt_date, y = contb_receipt_amt), 
       data = subset(CA, CA$year >= 2015 &
                       (CA$contb_receipt_amt > 0) &
                       (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco'))) +
  geom_point(alpha = 0.05) +
  scale_y_continuous(limits = c(0, 10000))

```

Scatter plot of amount vs. date for selected candidates.

```{r echo=FALSE, message=FALSE, warning=FALSE, boxplots}
# Box Plot of amount vs cand_nm
# We are looking at how categorical variables change with candidate names.
ggplot(aes(x = cand_nm, y = contb_receipt_amt), 
       data = subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco'))) +
  geom_boxplot() +
  scale_y_continuous(limits = c(0, 150))

# Stat summaries
cand_names <- table(CA$cand_nm)
by(CA$contb_receipt_amt, CA$cand_nm, summary)


# Box Plot of Amount vs Occupation
# I chose a few specific occupations
ggplot(aes(x = contbr_occupation, y = contb_receipt_amt), 
       data = subset(CA, CA$contbr_occupation == 'LAWYER'
                     | CA$contbr_occupation == 'ATTORNEY'
                     | CA$contbr_occupation == 'ENGINEER'
                     | CA$contbr_occupation == 'SOFTWARE ENGINEER'
                     | CA$contbr_occupation == 'DOCTOR'
                     | CA$contbr_occupation == 'TEACHER')) +
  geom_boxplot() +
  scale_y_continuous(limits = c(0, 400))


# Box Plot of Amount vs Employer
# for a few employers
ggplot(aes(x = contbr_employer, y = contb_receipt_amt), 
       data = subset(CA, CA$contbr_employer == 'APPLE INC.'
                     | CA$contbr_employer == 'GOOGLE'
                     | CA$contbr_employer == 'FACEBOOK'
                     | CA$contbr_employer == 'WELLS FARGO'
                     | CA$contbr_employer == 'GENENTECH'
                     | CA$contbr_employer == 'ORACLE CORP.'
                     | CA$contbr_employer == 'AT&T'
                     | CA$contbr_employer == 'NORTHROP GRUMMAN'
                     | CA$contbr_employer == 'UNITED AIRLINES'
                     | CA$contbr_employer == 'BANK OF AMERICA'
                     | CA$contbr_employer == 'VISA, INC.'
                     | CA$contbr_employer == 'DISNEY'
                     | CA$contbr_employer == 'ORACLE CORP.'
                     | CA$contbr_employer == 'WARNER BROS.'
                     | CA$contbr_employer == 'U.S. NAVY'
                     | CA$contbr_employer == '20TH CENTURY FOX')) +
  geom_boxplot() +
  coord_flip() +
  scale_y_log10()

```

Boxplots of contributions amount vs. candidate name, contributor occupation, 
and contributor employer.

```{r echo=TRUE, message=FALSE, warning=FALSE, industry_column}
### Boxplot of amount vs. industry

### Create vectors for each 'job field' for selected jobs
WHITE_COLLAR <- c("ENGINEER", "SOFTWARE ENGINEER", "SOFTWARE DEVELOPER", 
                  "WEB DEVELOPER", "IT", "ARCHITECT", "SCIENTIST", 
                  "RESEARCHER", "PHYSICIAN", "REGISTERED NURSE", "NURSE",
                  "RN", "PHARMACIST", "NURSE PRACTITIONER", "DENTIST", 
                  "DOCTOR", "MD", "PSYCHOLOGIST", "LAWYER", "ATTORNEY",
                  "PARALEGAL", "JUDGE ADVOCATE", "JUDGE", "SALES", 
                  "SALES MANAGER", "ANALYST", "MARKETING", "CONSULTANT",
                  "REALTOR", "DESIGNER", "PROJECT MANAGER", "ADMINISTRATOR",
                  "REAL ESTATE", "HUMAN RESOURCES", "PROPERTY MANAGER",
                  "REAL ESTATE BROKER", "ACCOUNTANT", "FINANCE", "CPA",
                  "INVESTOR", "BANKER", "CEO", "CFO", "PRESIDENT", 
                  "VICE PRESIDENT", "EXECUTIVE", "TEACHER", "PROFESSOR",
                  "COLLEGE PROFESSOR", "EDUCATOR", "BEHAVIORAL THERAPIST",
                  "PHYSICAL THERAPIST", "LECTURER", "MATHEMATICS INSTRUCTOR",
                  "BUSINESS DEVELOPMENT", "BIOLOGIST", "SOCIAL WORKER",                
                  "GAME DEVELOPER", "SURGEON", "DATABASE ADMINISTRATOR", 
                  "CHIEF FINANCIAL OFFICER", "DATA SCIENTIST", 
                  "DEV-OPS ENGINEER", "AEROSPACE ENGINEER")

BLUE_COLLAR <- c("BUSINESS OWNER", "SMALL BUSINESS OWNER", "OWNER", 
                 "ENTREPRENEUR", "SELF EMPLOYED", "FARMER", "TRUCK DRIVER",
                 "DRIVER", "CONTRACTOR", "BOOKKEEPER", "CLERICAL", 
                 "SHOP OWNER", "HOMEMAKER", "LABORER", "DELIVERY DRIVER",
                 "SECRETARY", "TSA OFFICER", "SALON/SPA", "FORKLIFT DRIVER",
                 "DATA ENTRY", "COOK", "SECURITY GUARD", "ELECTRICIAN",
                 "ASSISTANT MANAGER", "RETAIL SALES", "DEALER", 
                 "CUSTOMER SERVICE", "FLIGHT ATTENDANT", "FIRE FIGHTER",
                 "CARPENTER", "RANCHER", "CASHIER", "SERVER", "WAITER", 
                 "WAITRESS")

STUDENT <- c("STUDENT", "GRADUATE STUDENT")

UNEMPLOYED <- c("DISABLED", "NOT EMPLOYED", "UNEMPLOYED", 
                "UNEMPLOYED BECAUSE OF OBAMACARE")

MILITARY <- c("U.S. NAVY", "UNITED STATES NAVY", "NAVY", "DEPT. OF NAVY",
              "DEPARTMENT OF NAVY", "DEPARTMENT OF THE NAVY", 
              "U.S. DEPARTMENT OF THE NAVY", "NAVY FEDERAL CREDIT UNION", 
              "USNAVY", "U.S. ARMY", "ARMY", "US ARMY",
              "U.S. DEPARTMENT OF THE ARMY", "U.S. ARMY CORPS. OF ENGINEERS",
              "DEPT OF ARMY", "U S ARMY", "U.S. COAST GUARD", "US COAST GUARD",
              "UNITED STATES COAST GUARD", "U.S. DEPARTMENT OF THE COAST GUARD",
              "DOD", "D.O.D.")

RETIRED <- c("RETIRED")

### Create 'job field' column.  If contbr_occupation is in a job field vector 
### from above, add the name of the vector to 'job field' column
CA$contbr_industry <- ifelse(CA$contbr_occupation %in% WHITE_COLLAR,
                             "WHITE COLLAR",
                      ifelse(CA$contbr_occupation %in% BLUE_COLLAR, 
                             "BLUE COLLAR",
                      ifelse(CA$contbr_occupation %in% STUDENT, 
                             "STUDENT",
                      ifelse(CA$contbr_occupation %in% UNEMPLOYED, 
                             "UNEMPLOYED",
                      ifelse(CA$contbr_employer %in% MILITARY, 
                             "MILITARY",
                      ifelse(CA$contbr_occupation %in% RETIRED, 
                             "RETIRED", "NULL"))))))
```

I created a new variable 'contbr_industry' that has 5 possible job categories.  
Each job category contains a list of possible job titles from the lists I made.  
The 'contbr_industry' column does not contain all jobs in the dataset. 

```{r echo=FALSE, message=FALSE, warning=FALSE, industry_boxplot}
# Boxplot of amount vs. industry
ggplot(aes(x = contbr_industry, y = contb_receipt_amt), 
       data = subset(CA, (CA$contbr_industry != "NULL") & 
                       (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco'))) +
  geom_boxplot() +
  scale_y_continuous(limits = c(-300, 1000))

# Stat summaries
job_fields <- table(CA$contbr_industry)
by(CA$contb_receipt_amt, CA$contbr_industry, summary)

```

I made a boxplot of amount vs. industry category and excluded data from jobs 
that were not in my industry category lists.  Every category had a lot of 
refund transactions with the exception of military employees and students.

```{r echo=TRUE, message=FALSE, warning=FALSE, county_column}
### Make a list of all cities in those counties

LA <- c("AGOURA HILLS", "ALHAMBRA", "ARCADIA", "ARTESIA", "AVALON", "AZUSA", 
        "BALDWIN PARK", "BELL", "BELL GARDENS", "BELLFLOWER", "BEVERLY HILLS",
        "BRADBURY", "BURBANK", "CALABASAS", "CARSON", "CERRITOS", "CLAREMONT",
        "COMMERCE", "COMPTON", "COVINA", "CUDAHY", "CULVER CITY", "DIAMOND BAR",
        "DOWNEY", "DUARTE", "EL MONTE", "EL SEGUNDO", "GARDENA", "GLENDALE", 
        "GLENDORA", "HAWAIIAN GARDENS", "HAWTHORNE", "HERMOSA BEACH", 
        "HIDDEN HILLS", "HUNTINGTON PARK", "INDUSTRY", "INGLEWOOD", "IRWINDALE",
        "LA CANADA FLINTRIDGE", "LA HABRA HEIGHTS", "LA MIRADA", "LA PUENTE", 
        "LA VERNE", "LAKEWOOD", "LANCASTER", "LAWNDALE", "LOMITA", "LONG BEACH", 
        "LOS ANGELES", "LYNWOOD", "MALIBU", "MANHATTAN BEACH", "MAYWOOD", 
        "MONROVIA", "MONTEBELLO", "MONTEREY PARK", "NORWALK", "PALMDALE", 
        "PALOS VERDES ESTATES", "PARAMOUNT", "PASADENA", "PICO RIVERA", 
        "POMONA", "RANCHO PALOS VERDES", "REDONDO BEACH", "ROLLING HILLS", 
        "ROLLING HILLS ESTATES", "ROSEMEAD", "SAN DIMAS", "SAN FERNANDO", 
        "SAN GABRIEL", "SAN MARINO", "SANTA CLARITA", "SANTA FE SPRINGS", 
        "SANTA MONICA", "SIERRA MADRE", "SIGNAL HILL", "SOUTH EL MONTE", 
        "SOUTH GATE", "SOUTH PASADENA", "TEMPLE CITY", "TORRANCE", "VERNON", 
        "WALNUT", "WEST COVINA", "WEST HOLLYWOOD", "WESTLAKE VILLAGE", 
        "WHITTIER")

SD <- c("CARLSBAD", "CHULA VISTA", "CORONADO", "DEL MAR", "EL CAJON", 
        "ENCINITAS", "ESCONDIDO", "IMPERIAL BEACH", "LA MESA", 
        "LEMON GROVE", "NATIONAL CITY", "OCEANSIDE", "POWAY", "SAN DIEGO",
        "SAN MARCOS", "SANTEE", "SOLANA BEACH", "VISTA")

ORANGE <- c("ALISO VIEJO", "ANAHEIM", "BREA", "BUENA PARK", "COSTA MESA", 
            "CYPRESS", "DANA POINT", "FOUNTAIN VALLEY", "FULLERTON", 
            "GARDEN GROVE", "HUNTINGTON BEACH", "IRVINE", "LA HABRA", 
            "LA PALMA", "LAGUNA BEACH", "LAGUNA HILLS", "LAGUNA NIGUEL", 
            "LAGUNA WOODS", "LAKE FOREST", "LOS ALAMITOS", "MISSION VIEJO", 
            "NEWPORT BEACH", "ORANGE", "PLACENTIA", 
            "RANCHO SANTA MARGARITA", "SAN CLEMENTE", "SAN JUAN CAPISTRANO", 
            "SANTA ANA", "SEAL BEACH", "STANTON", "TUSTIN", "VILLA PARK", 
            "WESTMINSTER", "YORBA LINDA")

SAC <- c("CITRUS HEIGHTS", "ELK GROVE", "FOLSOM", "GALT", "ISLETON", 
         "RANCHO CORDOVA", "SACRAMENTO")

BAY_AREA <- c("ALAMEDA", "ALBANY", "AMERICAN CANYON", "ANTIOCH", "ATHERTON", 
              "BELMONT", "BELVEDERE", "BENICIA", "BERKELEY", "BRENTWOOD", 
              "BRISBANE", "BURLINGAME", "CALISTOGA", "CAMPBELL", "CLAYTON", 
              "CLOVERDALE", "COLMA", "CONCORD", "CORTE MADERA", "COTATI", 
              "CUPERTINO", "DALY CITY", "DANVILLE", "DIXON", "DUBLIN", 
              "EAST PALO ALTO", "EL CERRITO", "EMERYVILLE", "FAIRFAX", 
              "FAIRFIELD", "FOSTER CITY", "FREMONT", "GILROY", 
              "HALF MOON BAY", "HAYWARD", "HEALDSBURG", "HERCULES", 
              "HILLSBOROUGH", "LAFAYETTE", "LARKSPUR", "LIVERMORE", 
              "LOS ALTOS", "LOS ALTOS HILLS", "LOS GATOS", "MARTINEZ", 
              "MENLO PARK", "MILL VALLEY", "MILLBRAE", "MILPITAS", 
              "MONTE SERENO", "MORAGA", "MORGAN HILL", "MOUNTAIN VIEW", 
              "NAPA", "NEWARK", "NOVATO", "OAKLAND", "OAKLEY", "ORINDA", 
              "PACIFICA", "PALO ALTO", "PETALUMA", "PIEDMONT", "PINOLE", 
              "PITTSBURG", "PLEASANT HILL", "PLEASANTON", "PORTOLA VALLEY", 
              "REDWOOD CITY", "RICHMOND", "RIO VISTA", "ROHNERT PARK", 
              "ROSS", "ST. HELENA", "SAN ANSELMO", "SAN BRUNO", 
              "SAN CARLOS", "SAN FRANCISCO", "SAN JOSE", "SAN LEANDRO", 
              "SAN MATEO", "SAN PABLO", "SAN RAFAEL", "SAN RAMON", 
              "SANTA CLARA", "SANTA ROSA", "SARATOGA", "SAUSALITO", 
              "SEBASTOPOL", "SONOMA", "SOUTH SAN FRANCISCO", "SUISUN CITY", 
              "SUNNYVALE", "TIBURON", "UNION CITY", "VACAVILLE", "VALLEJO", 
              "WALNUT CREEK", "WINDSOR", "WOODSIDE", "YOUNTVILLE")

RIVERSIDE <- c("BANNING", "BEAUMONT", "BLYTHE", "CALIMESA", "CANYON LAKE", 
               "CATHEDRAL CITY", "COACHELLA", "CORONA", 
               "DESERT HOT SPRINGS", "EASTVALE", "HEMET", "INDIAN WELLS", 
               "INDIO", "JURUPA VALLEY", "LAKE ELSINORE", "LA QUINTA", 
               "MENIFEE", "MORENO VALLEY", "MURRIETA", "NORCO", 
               "PALM DESERT", "PALM SPRINGS", "PERRIS", "RANCHO MIRAGE", 
               "RIVERSIDE", "SAN JACINTO", "TEMECULA", "WILDOMAR")

SAN_BERN <- c("ADELANTO", "APPLE VALLEY", "BARSTOW", "BIG BEAR LAKE", 
              "CHINO", "CHINO HILLS", "COLTON", "CRESTLINE", "FONTANA", 
              "GRAND TERRACE", "HESPERIA", "HIGHLAND", "JOSHUA TREE", 
              "LAKE ARROWHEAD", "LOMA LINDA", "LUCERNE VALLEY", "MONTCLAIR", 
              "NEEDLES", "ONTARIO", "RANCHO CUCAMONGA", "REDLANDS", "RIALTO", 
              "RUNNING SPRINGS", "SAN BERNARDINO", "TWENTYNINE PALMS", 
              "UPLAND", "VICTORVILLE", "WRIGHTWOOD", "YERMO", "YUCAIPA", 
              "YUCCA VALLEY")

### create columns for each region

CA$contbr_county <- ifelse(CA$contbr_city %in% LA, "LA",
                    ifelse(CA$contbr_city %in% SD, "SD",
                    ifelse(CA$contbr_city %in% ORANGE, "ORANGE",
                    ifelse(CA$contbr_city %in% SAC, "SAC",
                    ifelse(CA$contbr_city %in% BAY_AREA, "BAY AREA",
                    ifelse(CA$contbr_city %in% RIVERSIDE, "RIVERSIDE",
                    ifelse(CA$contbr_city %in% SAN_BERN, 
                           "SAN BERN", "NULL")))))))
```

I chose 7 counties(LA, San Diego, Orange, Sacramento, SF Bay Area, Riverside, 
San Bernardino) in California and made a list of all cities in each county.  
I created a new variable 'contbr_county' that assigns a county to a city.

```{r echo=FALSE, message=FALSE, warning=FALSE, county_boxplot}
### Boxplot of amount vs county

ggplot(aes(x = contbr_county, y = contb_receipt_amt), 
       data = subset(CA, (CA$contbr_county != "NULL") & 
                       (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco'))) +
  geom_boxplot() +
  scale_y_log10()

# Stat summaries
counties <- table(CA$contbr_county)
by(CA$contb_receipt_amt, CA$contbr_county, summary)

```

This is a boxplot of contribution amount vs. county.  The summary statistics 
for each county were very similar.  Because the y values were very spread out,
I applied a log scale to the y axis.

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

My scatter plot of amount vs. date again showed that most contributions were 
less than or equal to 2700.  There were a few contributions near 10000 in late 
2015 and early 2016.  Bernie Sanders and Hillary Clinton had the lowest mean 
contributions.  Marco Rubio had the highest average contribution.  When I 
compared the contributions made from 6 white collar professions, Doctors and 
Lawyers had the highest average contributions.  When I compared contributions 
from employees at specific companies, Facebook, Genentech and Google had the 
highest average contributions.  Visa had the lowest average contribution.

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?  

I made a boxplot of amount vs. county for 7 counties in california(LA, SD, 
ORANGE, SAC, RIVERSIDE, SAN BERN, BAY AREA).  The means, first and third 
quartiles for all 7 counties were very close together.  Riverside, 
San Bernardino, Sacramento, and San Diego had smaller contribution amounts.  
Bay Area cities and Los Angeles had the highest contributions amounts.

### What was the strongest relationship you found? 

The boxplot of amount vs. contbr_employer showed the most variation in mean 
contribution amounts.  Employees of entertainment companies like 20th Century 
Fox and Disney appeared to have lower mean and max contributions.  Employees 
at financial companies like Bank of America and Visa appeared to give less 
money as well, however, Wells Fargo employees had higher max contributions.  
Of the large companies I selected, Google, Facebook and Apple employees gave 
the most money. 

# Multivariate Plots Section

```{r echo=TRUE, message=FALSE, warning=FALSE, cumsum_variables}
### Add column for cumulative sum of amount, group by cand name and date
### This gives me the total contribution SO FAR, for each candidate on each 
### date
CA$total_contbr <- ave(CA$contb_receipt_amt, CA$cand_nm, 
                       CA$contb_receipt_dt_date, FUN=cumsum)

### Add column for max of total contribution
### This gives me the MAX of total contribution for each candidate on each 
### date
CA$max_total_contbr <- ave(CA$total_contbr, CA$cand_nm, 
                           CA$contb_receipt_dt_date, FUN=max)

### Need to sum over industries and counties
### Add column for cumulative sum of amount, group by industry and date
### This gives me the total contribution SO FAR, for each industry on 
### each date
CA$total_contbr_industry <- ave(CA$contb_receipt_amt, CA$contbr_industry,
                                CA$contb_receipt_dt_date, FUN=cumsum)

### Add column for max of total contribution
### This gives me the MAX of total contribution for each industry on each 
### date
CA$max_total_contbr_industry <- ave(CA$total_contbr_industry, 
                                    CA$contbr_industry, 
                                    CA$contb_receipt_dt_date, FUN=max)

### Add column for cumulative sum of amount, group by county and date
### This gives me the total contribution SO FAR, for each county on each 
### date
CA$total_contbr_county <- ave(CA$contb_receipt_amt, CA$contbr_county,
                              CA$contb_receipt_dt_date, FUN=cumsum)

### Add column for max of total contribution
### This gives me the MAX of total contribution for each county on each date
CA$max_total_contbr_county <- ave(CA$total_contbr_county, CA$contbr_county,
                                  CA$contb_receipt_dt_date, FUN=max)
```

I created 6 new columns.  The column 'total_contbr' gives me the cumulative sum 
for each candidate on each date SO FAR.  The column 'max_total_contbr' gives me 
the MAX of total contributions for each candidate on each date.  The column 'total_contbr_industry' gives the cumulative sum for each industry category on 
each date so far.  'max_total_contbr_industry' gives the max of total 
contributions for each industry category on each date.  I repeated this process 
to create 'total_contbr_county' and 'max_total_contbr_county'.

```{r echo=FALSE, message=FALSE, warning=FALSE, lineplot_maxtotal_date}
# Line Plot of Max Total Contributions vs Date, grouped by candidate name.
ggplot(subset(CA, (CA$contb_receipt_amt > 0) & 
                (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\'')),  aes(contb_receipt_dt_date, max_total_contbr, colour = cand_nm)) +
  geom_line() 
```

I made a line plot of max total contribution vs. date and grouped by candidate 
name.  

```{r echo=FALSE, message=FALSE, warning=FALSE, smooth_maxtotal_date_candname}
# SMOOTH LINE Plot of Max Total Contributions vs Date, grouped by cand_nm
ggplot(subset(CA, (CA$max_total_contbr > 0) & 
                (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\'')),  aes(contb_receipt_dt_date, max_total_contbr, colour = cand_nm)) +
  stat_smooth(formula = y ~ poly(x,3)) +
  scale_y_continuous(limits = c(0, max(CA$max_total_contbr)))
```

Smooth line plot of max total contribution vs. date and grouped by candidate 
name.

```{r echo=FALSE, message=FALSE, warning=FALSE, smooth_maxtotal_date_industry}
### SMOOTH LINEPLOT of max contributions vs date, grouped by contbr_industry
ggplot(subset(CA, (CA$contb_receipt_amt > 0) & 
                (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\'') &
                (CA$contbr_industry != "NULL")),
                aes(contb_receipt_dt_date, max_total_contbr, 
                    colour = contbr_industry)) +
  stat_smooth(se = FALSE, span = 0.01) +
  scale_y_continuous(limits = c(0, max(CA$max_total_contbr))) +
  scale_colour_brewer(palette = "Spectral") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))

```

Grouped by industry category.

```{r echo=FALSE, message=FALSE, warning=FALSE, smooth_maxtotal_date_county}
### SMOOTH LINEPLOT max total contribution vs date, colored by county
ggplot(subset(CA, (CA$max_total_contbr_county > 0) & 
                (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\'') &
                (CA$contbr_county != "NULL")),
                aes(contb_receipt_dt_date, max_total_contbr_county, 
                    colour = contbr_county)) +
  stat_smooth(se = FALSE, span = 0.01) +
  scale_colour_brewer(palette = "Spectral") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))
```

Grouped by County

```{r echo=FALSE, message=FALSE, warning=FALSE, smooth_industry_wrapped_cand}
### SMOOTH LINEPLOT of max contributions vs date, grouped by contbr_industry, 
### facet wrapped by cand_nm
ggplot(subset(CA, (CA$contb_receipt_amt > 0) & 
                (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\'') &
                (CA$contbr_industry != "NULL")),
                aes(contb_receipt_dt_date, max_total_contbr_industry, 
                    colour = contbr_industry)) +
  stat_smooth(se = FALSE, span = 0.01) +
  facet_wrap(~ cand_nm, scales = "free") +
  scale_colour_brewer(palette = "Spectral") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))
```

Smooth line plot of max contributions vs date, grouped by contbr_industry, 
facet wrapped by cand_nm

```{r echo=FALSE, message=FALSE, warning=FALSE, scatter_amount_vs_date_wrapped}
### Amount vs Date, colored by contbr_industry, facet wrapped by cand_nm
ggplot(aes(x = contb_receipt_dt_date, y = contb_receipt_amt), 
       data = subset(CA, (CA$contb_receipt_amt > 0) &
                       (CA$contbr_industry != "NULL") &
                       (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco'))) +
  geom_point(aes(colour = contbr_industry), alpha = 0.5) +
  coord_flip() +
  scale_colour_brewer(palette = "Spectral") +
  facet_wrap(~ cand_nm, scales = "free", ncol = 2) +
  scale_y_continuous(limits = c(0, 10000)) +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))
```

Scatter plot of contribution amount vs. date, colored by industry and facet 
wrapped by candidate name.  Republican candidates had far more retired 
contributors.  Bernie Sanders had a lot of unemployed contributors.

```{r echo=FALSE, message=FALSE, warning=FALSE, amount_vs_date_employer}
# Amount vs Date, colored by candidate name, facet wrapped by employer
ggplot(aes(x = contb_receipt_dt_date, y = contb_receipt_amt), 
       data = subset(CA, CA$year >= 2015 &
                       (CA$contb_receipt_amt > 0) &
                       (CA$contbr_employer == 'GOOGLE'
                     | CA$contbr_employer == 'FACEBOOK'
                     | CA$contbr_employer == 'WELLS FARGO'
                     | CA$contbr_employer == 'GENENTECH'
                     | CA$contbr_employer == 'AT&T'
                     | CA$contbr_employer == 'NORTHROP GRUMMAN'
                     | CA$contbr_employer == 'UNITED AIRLINES'
                     | CA$contbr_employer == 'BANK OF AMERICA'
                     | CA$contbr_employer == 'DISNEY'
                     | CA$contbr_employer == 'WARNER BROS.'
                     | CA$contbr_employer == 'U.S. NAVY') &
                       (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''))) +
  geom_point(aes(colour = cand_nm)) +
  scale_colour_brewer(palette = "Spectral") +
  facet_wrap(~ contbr_employer, scales = "free") +
  scale_y_continuous(limits = c(0, 5000)) +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))
```

Scatter plot of contribution amount vs. date, colored by candidate name and 
facet wrapped by employer.

```{r echo=TRUE, message=FALSE, warning=FALSE, numericdate_column}

# Add column that converts date to numeric value

CA$numeric_date <- as.numeric(CA$contb_receipt_dt_date)
```

I converted dates to numeric date values because I wanted to perform scaling 
operations on the date column in some of my plots.

```{r echo=FALSE, message=FALSE, warning=FALSE, Scatter_Date_MaxContribution}
### Exploring correlation between date and max contribution over categorical 
### variables.

# scatter plot of date vs max contrib, colored by cand_nm
# As max contribution values increase, they show up on fewer dates
# and those dates are later in the time period.

ggplot(subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco')),  
       aes(x = max_total_contbr, y = numeric_date, colour = cand_nm)) +
  geom_point() +
  scale_colour_brewer(palette = "Spectral") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))

```

Earlier I looked contribution amount vs. date.  This is numeric date vs. max 
total contribution amount, colored by candidate name.  I chose to look at date 
as a function of contribution because one contribution amount has fewer date 
values than the number of contribution values that one date has.  I was hoping 
to tease out a relationship between the date and contribution amount.

```{r echo=FALSE, message=FALSE, warning=FALSE, Scatter_LogDate_MaxTotal}
ggplot(subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco')),  
       aes(x = max_total_contbr, y = numeric_date, colour = cand_nm)) +
  geom_point() +
  scale_y_log10() +
  scale_colour_brewer(palette = "Spectral") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))

```

This is the log(numeric date) vs. max total contribution, colored by candidate 
name.  Applying the log scale to the y axis helped show that higher 
contribution totals appeared closer to the election date.  It was not a linear 
relationship but there was some correlation.

```{r echo=FALSE, message=FALSE, warning=FALSE, LogDate_MaxTotal_Industry}
## Scatter plot of date vs max contribution, colored by contbr_industry
ggplot(subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco') &
                CA$contbr_industry != 'NULL'),  
       aes(x = max_total_contbr_industry, y = numeric_date, 
           colour = contbr_industry)) +
  geom_point() +
  scale_y_log10() +
  scale_colour_brewer(palette = "Reds") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))
```

Log(numeric date) vs. max_total_contbr_industry, colored by contbr_industry.

```{r echo=FALSE, message=FALSE, warning=FALSE, LogDate_MaxTotal_County}

## Scatter plot of date vs max contribution, colored by contbr_county

ggplot(subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco') &
                CA$contbr_county != 'NULL'),  
       aes(x = max_total_contbr_county, y = numeric_date, 
           colour = contbr_county)) +
  geom_point() +
  scale_y_log10() +
  scale_colour_brewer(palette = "Spectral") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))


```

Log(numeric date) vs. max_total_contbr_industry, colored by contbr_county.

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

The line plot of max total contributions vs. date shows only very small 
contributions to Trump's campaign prior to June 2016.  During this time, 
Ted Cruz had the majority of Republican contributions.   After June 2016 the 
contributions per day to Trump's campaign increased.

The smooth line plot of max total contributions vs. date, colored by 
contbr_industry and facet wrapped by cand_nm showed very little difference 
between the contributions made by blue collar, white collar, unemployed, 
student or military contributors.

The smooth line plot of max total contributions vs. date, colored by occupation 
showed all chosen occupations making more contributions as the election date 
approached.  People who were retired gave cumulatively less per date while 
people with the title of software engineer, customer service or student, 
oscillated up and down while steadily increasing.

The scatterplot of amount vs. date, colored by contbr_industry and facet 
wrapped by cand_nm showed a large number of white collar contributors to 
Hillary Clinton's campaign.  The majority of contributors to Republican 
candidates were retired.  Ben Carson, Ted Cruz, and Donald Trump had fewer 
white collar contributors.  Bernie Sanders had a lot of unemployed contributors.

The scatterplot of amount vs. date, colored by cand_nm and facet wrapped by 
employer showed many of the selected companies to be dominated by Hillary 
Clinton supporters.  Wells Fargo, United Airlines, Northrup Grumman, and AT&T 
held the most politically diverse employees.

I converted date to a numeric value and explored the correlation between max 
contribution and the log of the numerical date over categorical variables such 
as cand_nm, contbr_industry, and contbr_county.  Larger totals for daily 
contributions appeared closer to the election date and were mostly made to 
Hillary Clinton.  Donald Trump did not receive visible daily total 
contributions until near the election date and most of them were under 250000.  
Smaller cumulative contributions per date for my selected industries came from 
military employees and students.  The largest sums per date were from white 
collar employees but there were many large sums per date from unemployed 
people.  It's possible that some of them simply put unemployed on their form as
a means of opting out from disclosing private information.  The highest 
cumulative contributions per date for my selected counties were from the San 
Francisco Bay Area or Los Angeles County.  Orange County and San Diego County 
were close behind.  

### Were there any interesting or surprising interactions between features?

I didn't expect contributors to Bernie Sanders and Donald Trump be from the 
same industry categories.  There were many blue collar contributors to both 
candidates.  The list of blue collar occupations I created mixed traditional 
blue collar jobs such as contruction or plumbing with modern jobs such as 
cashier or customer service.  I was surprised at the high number of retired 
contributors.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, warning=FALSE, Plot_One}
# Histogram of the log of the number of people who gave each amount

ggplot(aes(x = contb_receipt_amt), data = CA) +
  geom_histogram(col = "black", fill = "gold", bins = 250) +
  scale_x_continuous(limits = c(0, 5000)) +
  scale_y_log10() +
  ggtitle("Histogram of Contribution ($)") + 
  theme(plot.title = element_text(lineheight=.8, face="bold")) +
  labs(x = "Contribution ($)") +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))

```

### Description One

The counts for each contribution amount were very spread out.  There appeared 
to be large gaps between contributions of $500 and $3000.  Once I applied a 
log10() scale to the y axis these smaller counts were visible.

### Plot Two
```{r echo=FALSE, warning=FALSE, Plot_Two}

library(gridExtra)

# boxplot of amount vs industry
p1 <- ggplot(aes(x = contbr_industry, y = contb_receipt_amt, 
                 fill = contbr_industry), 
       data = subset(CA, (CA$contbr_industry != "NULL") & 
                       (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco'))) +
  geom_boxplot() +
  coord_flip() +
  scale_y_log10() +
  scale_fill_brewer(palette="Greens") +
  ggtitle("Contribution Amount vs Industry") + 
  theme(plot.title = element_text(lineheight=.8, face="bold")) +
  labs(x = "Industry", y = "Contribution ($)") +
  guides(fill=guide_legend(title="Industry")) +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))


# SMOOTH LINE Plot of Max Total Contributions vs Date, grouped by 
# candidate name.
p2 <- ggplot(subset(CA, (CA$max_total_contbr > 0) & 
                (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Sanders, Bernard'
                     | CA$cand_nm == 'Trump, Donald J.'
                     | CA$cand_nm == 'Cruz, Rafael Edward \'Ted\''
                     | CA$cand_nm == 'Carson, Benjamin S.'
                     | CA$cand_nm == 'Rubio, Marco')),  
             aes(contb_receipt_dt_date, max_total_contbr, 
                 colour = cand_nm)) +
  stat_smooth(formula = y ~ poly(x,3)) +
  scale_y_continuous(limits = c(0, max(CA$max_total_contbr))) +
  scale_colour_brewer(palette = "Blues") +
  ggtitle("Total Contribution vs Date") + 
  theme(plot.title = element_text(lineheight=.8, face="bold")) +
  labs(x = "Date", y = "Total Contribution ($)") +
  guides(colour=guide_legend(title="Candidate")) +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))


# Plot both plots together in one column
grid.arrange(p1, p2, ncol = 1)


```

### Description Two

I applied a log scale to the contribution axis of the boxplot so the scope of 
the values could be seen.  Blue collar, white collar, and unemployed 
contributors had similar mean and third quartile values for their contributions.  
Candidates recieved greater total contributions per date closer to the election 
date.  The correlation between the numeric date values and total contributions 
per candidate was 0.637.  Donald Trump received very small total contributions 
per date prior to July 2016.

### Plot Three
```{r echo=FALSE, warning=FALSE, Plot_Three} 
ggplot(subset(CA, (CA$cand_nm == 'Clinton, Hillary Rodham'
                     | CA$cand_nm == 'Trump, Donald J.') &
                CA$contbr_county != 'NULL'),  
       aes(x = (numeric_date)^(1/3), y = max_total_contbr_county, 
           colour = contbr_county)) +
  geom_point() +
  scale_y_log10() +
  scale_colour_brewer(palette = "Spectral") +
  ggtitle("Total Contributions by County vs Date") + 
  theme(plot.title = element_text(lineheight=.8, face="bold")) +
  labs(x = "Date (days)", y = "Total Contribution ($)") +
  guides(colour=guide_legend(title="County")) +
  theme(panel.background = element_rect(fill = "grey66"),
        panel.grid.major = element_line(colour = "grey50"),
        panel.grid.minor = element_line(colour = "grey60"))

cor(CA$numeric_date, CA$max_total_contbr_county)
 

```

### Description Three

I looked at the total contributions per date for each county.  I converted 
dates to numeric date values so I could apply scaling operations to them.
I applied a log scale to the y axis and a cube root scale on the x axis.  
I only included contributions to Hillary Clinton and Donald Trump.  The 
correlation between the numeric date value and the total contribution per 
county was 0.351.
------

# Reflection

Most of the data was made up of large categorical variables.  I had to find 
ways to organize these variables into fewer categories so I could include them 
in my plots.  I used contributor occupations to create industry categories.  I 
spent a lof of time creating lists of jobs to be included in my industry 
categories.  There were a lot of jobs that were not clearly white collar or 
blue collar and my lists could be more thorough.  I also used contributor 
cities to create contributor counties.  The occupation and city data was 
difficult to use because I had to choose subsets of it to include in my 
analysis. There were too many occupations and cities to include in my lists for 
each category.  

I created variables to sum contribution amounts over categorical variables such 
as candidate name, contributor industry category, contributor county.  Upon 
converting the dates to numeric values I observed a correlation between numeric 
date and total contribution per candidate of 0.637.  When I tested for 
correlation between numeric dates and total contribution per industry, the 
value was 0.432.  The correlation between numeric dates and total contribution 
per county was 0.351.  I had trouble deciding which of these three comparisons 
to show in my final plot.  Although there were stronger correlations between 
candidate sums and industry sums, I wanted to show some data on which parts of 
California the money was coming from.  

I was surprised to find a large number of military employees contributed to 
Bernie Sanders and Hillary Clinton.  It was also surprising that Donald Trump 
received very small total contribution per date until the other Republican 
candidates were no longer an option.  This analysis could be improved by 
programmatically reading the cities and occupations in the dataset and writing 
complete category lists for industry and county values.  I would eventually 
like to predict the contribution amount or total contribution received in one 
day.  

